<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cheque List Viewer for BISE BANNU">
    <title>A/c test BISEB</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Custom Styles -->
    <link rel="stylesheet" href="styles/style.css">

    <style>
        /* Add your custom styles here */
        .status-green { color: #28a745; font-weight: 500; }
        .status-red { color: #dc3545; font-weight: 500; }
        .status-blue { color: #007bff; font-weight: 500; }
        .status-gray { color: #6c757d; font-weight: 500; }
        .status-orange { color: #fd7e14; font-weight: 500; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <h1>Accounts Section: BISE Bannu Office</h1>
            <p class="text-muted">Check Information and Updates</p>
        </div>

        <!-- Search Section -->
        <div class="search-container d-flex flex-column flex-md-row align-items-center gap-3">
            <div class="input-group flex-grow-1">
                <input type="search" id="search" class="form-control" placeholder="Search..." aria-label="Search CHQS">
            </div>
            <div class="d-flex align-items-center gap-2 flex-grow-1">
                <select class="form-select flex-grow-1" id="narCategory">
                   <option value="all" selected>Search All Bills</option>
                    <option value="TA/DA TO SUPERVISORY STAFF SSC EXAM:">Supervisory Staff SSC</option>
                    <option value="TA/DA TO SUPERVISORY STAFF HSSC EXAM:">Supervisory Staff HSSC</option>
                    <option value="TA/DA TO PRACTICAL EXMR: SSC">Practical Staff SSC</option>
                    <option value="TA/DA TO PRACTICAL EXMR: HSSC">Practical Staff HSSC</option>
                    <option value="TA/DA TO INSEPCTORS SSC">Inspections Staff SSC</option>
                    <option value="TA/DA TO INSEPCTORS HSSC">Inspections Staf HSSC</option>
                    <option value="REMUNERATION RES: INSPECTORS">Resedent Inspectors</option>
                    <option value="LABORATORY CHARGES">Laboratory Charges</option>
                    <option value="TA/DA GENERAL">TA/DA General</option>
                    
                    <option value="MARKING SSC">Marking SSC</option>
                    <option value="MARKING HSSC">Marking HSSC</option>
                    <option value="REMUNERATION TO PAPER SETTER HSSC">Remuneration to Paper Setter HSSC</option>
                    <option value="REMUNERATION TO UFM MEMEBERS">Remuneration to UFM Members</option>
                    
                    <option value="EXPIRED CHECK RENEWED">Expired Check Renewed</option>
                    <option value="HONORARIA">Honoraria</option>
                    <option value="REFUND OF FEE">Refund of Fee</option>
                    <option value="RETOTALLING">Retotalling</option>
                    <!-- Add other NAR options here -->
                    <!-- Add other NAR options here -->
                </select>
                <button class="btn btn-primary" type="button" id="searchBtn">
                    <i class="fas fa-search"></i> Search
                </button>
                <select class="form-select flex-grow-1" id="statusFilter">
                    <option value="all" selected>All Statuses</option>
                    <option value="despatched through gpo">Despatched through GPO</option>
                    <option value="ready but not signed yet">Ready but not signed yet</option>
                    <option value="cheque ready">Cheque Ready</option>
                    <option value="despatched to lakki camp office">Despatched to Lakki Camp Office</option>
                    <option value="sent to chairman sb. for sign">Sent to Chairman SB for Sign</option>
                </select>
            </div>
        </div>

        <!-- Result Section -->
        <div id="result" class="alert alert-info" role="alert" style="display: none;"></div>
        <div class="table-responsive" id="tableContainer" style="display: none;">
            <table class="table table-hover" id="chequeTable">
                <thead>
                    <tr>
                        <th data-column="NARRATION">Payee(s) Name and Address <span class="sort-icon"></span></th>
                        <th data-column="AMOUNT">Amount <span class="sort-icon"></span></th>
                        <th data-column="CHEQ_NO">Cheque No <span class="sort-icon"></span></th>
                        <th data-column="NAR">In Care Of <span class="sort-icon"></span></th>
                        <th data-column="DD">Details Status <span class="sort-icon"></span></th>
                    </tr>
                </thead>
                <tbody id="checksTable"></tbody>
            </table>
        </div>

        <!-- Pagination -->
        <nav aria-label="Table pagination" id="pagination">
            <ul class="pagination justify-content-center">
                <li class="page-item disabled" id="prevPage">
                    <a class="page-link" href="#" tabindex="-1">Previous</a>
                </li>
                <li class="page-item active" id="page1">
                    <a class="page-link" href="#">1</a>
                </li>
                <li class="page-item" id="nextPage">
                    <a class="page-link" href="#">Next</a>
                </li>
            </ul>
        </nav>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState">
            <i class="fas fa-search"></i>
            <p class="lead">Enter the name or school name to view search results</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
       /**
/**
 * XMLTableHandler: Fixed implementation with defineColumns
 * Version: 5.2
 * Last Updated: 2025-02-16
 */
class XMLTableHandler {
    constructor() {
        console.log('üöÄ Initializing XMLTableHandler...');
        
        try {
            // Initialize core components
            this.defineColumns();  // Now defined as a method
            this.initializeDOMElements();
            this.initializeState();
            this.initializeEventListeners();
            
            console.log('‚úÖ XMLTableHandler initialization successful');
        } catch (error) {
            console.error('‚ùå Constructor Error:', error.message);
            this.showError('Failed to initialize table handler: ' + error.message);
        }
    }

    /**
     * Define table columns and their properties
     * @method defineColumns
     */
    defineColumns() {
        console.log('üìä Defining table columns...');
        
        this.columns = {
            NARRATION: { 
                index: 0, 
                type: 'string', 
                required: true,
                title: 'Narration'
            },
            AMOUNT: { 
                index: 1, 
                type: 'number', 
                required: true,
                title: 'Amount'
            },
            CHEQ_NO: { 
                index: 2, 
                type: 'number', 
                required: true,
                title: 'Cheque No'
            },
            NAR: { 
                index: 3, 
                type: 'string', 
                required: true,
                title: 'NAR'
            },
            DD: { 
                index: 4, 
                type: 'string', 
                required: true,
                title: 'Status'
            }
        };
        
        console.log('‚úÖ Column definitions completed:', Object.keys(this.columns));
    }

    /**
     * Initialize DOM elements with error checking
     */
    initializeDOMElements() {
        console.log('üîç Initializing DOM elements...');

        const required_elements = {
            'checksTable': 'tableBody',
            'search': 'searchInput',
            'narCategory': 'narFilter',
            'statusFilter': 'statusFilter',
            'tableContainer': 'tableContainer',
            'emptyState': 'emptyState',
            'result': 'resultContainer',
            'pagination': 'paginationContainer'
        };

        for (const [id, prop] of Object.entries(required_elements)) {
            const element = document.getElementById(id);
            if (!element) {
                throw new Error(`Required element #${id} not found in DOM`);
            }
            this[prop] = element;
            console.log(`‚úì Found ${id} element`);
        }
    }

    /**
     * Initialize state variables
     */
    initializeState() {
        console.log('üîÑ Initializing state...');
        
        this.state = {
            enableLiveUpdate: false,
            tableResetEnabled: true,
            backspaceDefault: true,
            xmlData: '',
            lastSearchTerm: '',
            currentStatusFilter: 'all',
            lastFilterCategory: 'all',
            rowsPerPage: 10,
            currentPage: 1,
            visibleRowsCount: 0,
            sortColumn: null,
            sortDirection: 'asc'
        };
        
        console.log('‚úÖ State initialized');
    }

    /**
     * Initialize event listeners
     */
    initializeEventListeners() {
        console.log('üëÇ Setting up event listeners...');

        try {
            this.setupSearchListeners();
            this.setupFilterListeners();
            this.setupPaginationListeners();
            this.setupSorting();
            
            console.log('‚úÖ Event listeners setup complete');
        } catch (error) {
            console.error('‚ùå Error in event listener setup:', error);
            this.showError('Failed to setup event listeners: ' + error.message);
        }
    }

    /**
     * Setup search functionality
     */
    setupSearchListeners() {
        if (!this.searchInput) {
            console.error('‚ùå Search input not found');
            return;
        }

        this.searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                console.log('üîç Search triggered by Enter key');
                this.performSearch();
            }
        });

        const searchBtn = document.getElementById('searchBtn');
        if (searchBtn) {
            searchBtn.addEventListener('click', () => {
                console.log('üîç Search triggered by button click');
                this.performSearch();
            });
        }
    }

    /**
     * Setup filter listeners
     */
    setupFilterListeners() {
        if (this.narFilter) {
            this.narFilter.addEventListener('change', () => {
                console.log('üìë NAR filter changed:', this.narFilter.value);
                this.applyFilters();
            });
        }

        if (this.statusFilter) {
            this.statusFilter.addEventListener('change', () => {
                console.log('üîÑ Status filter changed:', this.statusFilter.value);
                this.applyFilters();
            });
        }
    }

    /**
     * Setup pagination
     */
    setupPaginationListeners() {
        if (!this.paginationContainer) {
            console.warn('‚ö†Ô∏è Pagination container not found');
            return;
        }

        // Add pagination logic here
        console.log('üìÑ Pagination listeners setup');
    }

    /**
     * Setup sorting
     */
    setupSorting() {
        const headers = document.querySelectorAll('th[data-column]');
        headers.forEach(header => {
            header.addEventListener('click', () => {
                const column = header.dataset.column;
                console.log('üîÑ Sorting by column:', column);
                this.sortTable(column);
            });
        });
    }

    /**
     * Perform search
     */
    performSearch() {
        const searchTerm = this.searchInput.value.toLowerCase();
        console.log('üîç Performing search for:', searchTerm);
        
        this.state.lastSearchTerm = searchTerm;
        this.applyFilters();
    }

    /**
     * Apply all filters
     */
    applyFilters() {
        // Filter implementation
        console.log('üîÑ Applying filters...');
    }

    /**
     * Show error message
     */
    showError(message) {
        console.error('‚ùå Error:', message);
        if (this.resultContainer) {
            this.resultContainer.innerHTML = `
                <div class="alert alert-danger">
                    ${message}
                </div>
            `;
            this.resultContainer.style.display = 'block';
        }
    }
}

// Initialize handler
document.addEventListener('DOMContentLoaded', () => {
    console.log('üåü DOM Content Loaded - Starting initialization');
    
    try {
        window.tableHandler = new XMLTableHandler();
        console.log('‚úÖ Table handler initialized successfully');
    } catch (error) {
        console.error('‚ùå Initialization failed:', error);
        const errorDiv = document.createElement('div');
        errorDiv.className = 'alert alert-danger mt-3';
        errorDiv.innerHTML = `Failed to initialize table handler: ${error.message}`;
        document.body.insertBefore(errorDiv, document.body.firstChild);
    }
});
        
    </script>
</body>
</html>
